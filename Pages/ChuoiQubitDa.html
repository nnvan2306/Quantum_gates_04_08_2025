<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <title>Chu·ªói C·ªïng ‚Äì ƒêa Qubit</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script src="https://cdn.tailwindcss.com"></script>
        <link rel="stylesheet" href="../css/styles.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script>
        <script src="../js/Main.js"></script>
        <style>
            #button_control {
                background: #e53935;
                color: #fff;
                border: none;
                padding: 10px 20px;
                font-weight: 600;
                font-size: 14px;
                border-radius: 12px;
                cursor: pointer;
                box-shadow: 0 6px 16px -4px rgba(229, 57, 53, 0.6);
                transition: transform 0.1s, filter 0.1s;
                display: inline-block;
                line-height: 1;
            }
            #button_control:hover {
                filter: brightness(1.05);
                transform: translateY(-1px);
            }
            #button_control:active {
                transform: translateY(1px);
                box-shadow: 0 4px 12px -2px rgba(229, 57, 53, 0.6);
            }
        </style>
    </head>
    <body class="bg-gray-50 text-gray-900 min-h-screen flex flex-col">
        <!-- Header -->
        <header
            class="bg-black text-white p-4 flex justify-between items-center"
        >
            <div class="text-xl font-bold">QUANTUM GATES</div>
            <nav class="space-x-6 text-sm">
                <a href="index.html" class="hover:underline">Trang ch·ªß</a>
                <a href="Congluongtu.html" class="hover:underline"
                    >C·ªïng l∆∞·ª£ng t·ª≠</a
                >
                <a href="BaiViet.html" class="hover:underline">B√†i vi·∫øt</a>
                <a href="HoatDong.html" class="hover:underline">Ho·∫°t ƒë·ªông</a>
                <a href="Sukien.html" class="hover:underline">S·ª± ki·ªán</a>
                <a href="LienHe.html" class="hover:underline">Li√™n h·ªá</a>
                <a href="HoiVien.html" class="hover:underline">H·ªôi vi√™n</a>
                <button id="button_control"></button>
            </nav>
        </header>

        <!-- Main -->
        <main class="flex-grow px-4 md:px-20 py-12">
            <h1 class="text-3xl font-bold text-center mb-6">
                üîó Chu·ªói C·ªïng ‚Äì ƒêa Qubit
            </h1>
            <p class="text-center italic text-orange-600 text-lg mb-8">
                "Ch·ªçn tr·∫°ng th√°i v√† d√£y c·ªïng l∆∞·ª£ng t·ª≠ ƒë·ªÉ m√¥ ph·ªèng"
            </p>

            <!-- Ch·ªçn tr·∫°ng th√°i ƒë·∫ßu v√†o -->
            <div class="mb-6 max-w-md mx-auto">
                <label for="inputState" class="block mb-2 font-semibold"
                    >Tr·∫°ng th√°i ƒë·∫ßu v√†o:</label
                >
                <select
                    id="inputState"
                    class="w-full p-3 border border-gray-300 rounded shadow"
                >
                    <option value="00">|00‚ü©</option>
                    <option value="01">|01‚ü©</option>
                    <option value="10">|10‚ü©</option>
                    <option value="11">|11‚ü©</option>
                </select>
            </div>

            <!-- Ch·ªçn chu·ªói c·ªïng -->
            <div class="mb-6 max-w-md mx-auto">
                <label class="block mb-2 font-semibold"
                    >Ch·ªçn chu·ªói c√°c c·ªïng l∆∞·ª£ng t·ª≠:</label
                >
                <div class="flex flex-wrap gap-2">
                    <button
                        class="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 gate-btn"
                        data-gate="CNOT"
                    >
                        CNOT
                    </button>
                </div>
                <p
                    id="gateSequence"
                    class="mt-4 text-blue-700 font-medium text-center"
                >
                    Tr√¨nh t·ª±: (ch∆∞a c√≥)
                </p>
            </div>

            <!-- N√∫t m√¥ ph·ªèng -->
            <div class="flex justify-center mt-6">
                <button
                    onclick="simulateSequence()"
                    class="px-6 py-2 bg-green-600 text-white font-semibold rounded hover:bg-green-700 transition"
                >
                    M√¥ ph·ªèng chu·ªói
                </button>
            </div>

            <!-- K·∫øt qu·∫£ -->
            <div class="mt-10 max-w-3xl mx-auto bg-white p-6 rounded-xl shadow">
                <h2 class="text-xl font-bold mb-4 text-center">
                    K·∫øt qu·∫£ m√¥ ph·ªèng
                </h2>
                <div id="resultArea" class="text-gray-800 text-center italic">
                    ...
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer
            class="bg-black text-white p-6 mt-12 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"
        >
            <div>
                <h3 class="font-bold mb-2">V·ªÄ CH√öNG T√îI</h3>
                <p>Li√™n h·ªá: quantumgates@example.com</p>
                <p>Ch√≠nh s√°ch</p>
            </div>
            <div>
                <h3 class="font-bold mb-2">C·ªîNG L∆Ø·ª¢NG T·ª¨</h3>
                <p>Hadamard</p>
                <p>Pauli-X</p>
            </div>
            <div>
                <h3 class="font-bold mb-2">T√ÄI NGUY√äN</h3>
                <p>T√†i li·ªáu h·ªçc</p>
                <p>Bi·ªÉu ƒë·ªì tr·∫°ng th√°i</p>
            </div>
            <div>
                <h3 class="font-bold mb-2">LI√äN H·ªÜ</h3>
                <p>Tr∆∞·ªùng ƒê·∫°i h·ªçc K·ªπ thu·∫≠t - C·∫ßn Th∆°</p>
                <p>SƒêT: 0385 316 325</p>
            </div>
        </footer>

        <script>
            const gates = [];

            // L·∫Øng nghe click v√† c·∫≠p nh·∫≠t tr√¨nh t·ª± c·ªïng
            document.querySelectorAll(".gate-btn").forEach((btn) => {
                btn.addEventListener("click", () => {
                    const gate = btn.dataset.gate;
                    gates.push(gate);
                    document.getElementById("gateSequence").innerText =
                        "Tr√¨nh t·ª±: " + gates.join(" ‚Üí ");
                });
            });

            // M√¥ ph·ªèng chu·ªói c·ªïng 2 qubit (k·∫ø th·ª´a t·ª´ JS)
            function simulateSequence() {
                const input = document.getElementById("inputState").value;
                if (gates.length === 0) {
                    alert("Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt c·ªïng.");
                    return;
                }

                const result = applyGateSequence2Qubit(input, gates); // <-- K·∫ø th·ª´a h√†m JS
                const labels = ["|00‚ü©", "|01‚ü©", "|10‚ü©", "|11‚ü©"];

                // Hi·ªÉn th·ªã k·∫øt qu·∫£
                let html = `<strong>ƒê·∫ßu v√†o:</strong> |${input}‚ü©<br>`;
                html += `<strong>Chu·ªói c·ªïng:</strong> ${gates.join(
                    " ‚Üí "
                )}<br><br>`;
                html += `<strong>Tr·∫°ng th√°i ƒë·∫ßu ra:</strong><br>`;
                html +=
                    "|œà‚ü© = " +
                    result
                        .map((amp, i) => `(${formatComplex(amp)}) ${labels[i]}`)
                        .join(" + ") +
                    "<br><br>";

                html += `<strong>X√°c su·∫•t ƒëo:</strong><br>`;
                result.forEach((amp, i) => {
                    const prob = math.pow(math.abs(amp), 2).toFixed(4);
                    html += `P(${labels[i]}) = ${prob}<br>`;
                });

                document.getElementById("resultArea").innerHTML = html;
            }
        </script>
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const btn = document.getElementById("button_control");
                if (!btn) return;

                const token = localStorage.getItem("token");

                const setLogout = () => {
                    btn.textContent = "ƒêƒÉng xu·∫•t";
                    btn.onclick = () => {
                        localStorage.removeItem("token");
                        location.reload();
                    };
                };

                const setLogin = () => {
                    btn.textContent = "ƒêƒÉng nh·∫≠p";
                    btn.onclick = () => {
                        window.location.href = "/Pages/DangNhap.html";
                    };
                };

                if (token) {
                    setLogout();
                } else {
                    setLogin();
                }
            });
        </script>
    </body>
</html>
